function [obj] = objFunc(x, y, z, f, alpha)
obj = 0.0;
n_points = size(x, 1);
for i = 1 : n_points
    df = alpha(1) + alpha(2)*x(i) + alpha(3)*y(i) + alpha(4)*z(i) - f(i);
    obj = obj + df*df;
end
end

x = [0.629447372786358;0.811583874151238; ...
    -0.746026367412988;0.826751712278039; ...
    0.264718492450819;-0.804919190001181; ...
    -0.443003562265903;0.0937630384099677; ...
    0.915013670868595;0.929777070398553; ...
    -0.684773836644903;0.941185563521231; ...
    0.914333896485891;-0.0292487025543176; ...
    0.600560937777600;-0.716227322745569; ...
    -0.156477434747450;0.831471050378134; ...
    0.584414659119109;0.918984852785806;];
y = [0.311481398313174;-0.928576642851621; ...
    0.698258611737554;0.867986495515101; ...
    0.357470309715547;0.515480261156667; ...
    0.486264936249832;-0.215545960931664; ...
    0.310955780355113;-0.657626624376877; ...
    0.412092176039218;-0.936334307245159; ...
    -0.446154030078220;-0.907657218737692; ...
    -0.805736437528305;0.646915656654585; ...
    0.389657245951634;-0.365801039878279; ...
    0.900444097676710;-0.931107838994183;];
z = [-0.122511280687204;-0.236883085813983; ...
    0.531033576298005;0.590399802274126; ...
    -0.626254790891243;-0.0204712084235379;...
    -0.108827598578201;0.292626020222529; ...
    0.418729661716145;0.509373363964722; ...
    -0.447949846002843;0.359405353707350; ...
    0.310196007947681;-0.674776529610739; ...
    -0.762004636883247;-0.00327189603571409; ...
    0.919487917032162;-0.319228546667734; ...
    0.170535501959555;-0.552376121017726;];
f = [7.46050158822741;-0.0903014394162496; ...
    -5.73667600222888;-3.62423991970605; ...
    15.4319603101706;-0.0524399876662236; ...
    3.35621106471690;-7.36740115311349; ...
    -2.50323654396716;-10.4183661528906; ...
    9.54489781935015;-10.7992908777637; ...
    -5.32884920133278;7.17415301452523; ...
    10.8448561501950;2.91172875553738; ...
    -14.8214620510934;5.12991656772800; ...
    5.65849527215899;6.20726618955135;];
alpha0 = zeros(4, 1);
obj_func = @(alpha) objFunc(x, y, z, f, alpha);

% parameters of optimizer
optns = optimoptions(@fmincon, 'Display', 'iter', 'Algorithm', 'sqp');

% call the optimizer
[alpha, fval] = fmincon(obj_func, alpha0, [], [], [], [], ...
                        [], [], [], optns);
   
a = alpha
linearFunc = @(xyz) a(1) + a(2)*xyz(1) + a(3)*xyz(2) + a(4)*xyz(3);

xyz0 = zeros(3, 1);
lb = [-1, -1, -1];
ub = [1, 1, 1];
% call the optimizer
[xyz, fval] = fmincon(linearFunc, xyz0, [], [], [], [], ...
                      lb, ub, [], optns)

